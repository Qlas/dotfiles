- name: Install essential packages
  become: true
  community.general.pacman:
    name:
      - zsh

- name: Download oh-my-zsh installer
  ansible.builtin.get_url:
    url: https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh
    dest: "{{ ansible_env.HOME }}/.ohmyzsh_installer.sh"

- name: Run oh-my-zsh installer
  ansible.builtin.shell: "sh {{ ansible_env.HOME }}/.ohmyzsh_installer.sh"
  args:
    creates: "{{ ansible_env.HOME }}/.oh-my-zsh/"
  notify:
    - Ensure .zshrc is valid

